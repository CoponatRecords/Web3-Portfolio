import{E as k,F as B,G as L,I as M,J as O,r as x,K as P,j as a,C as W,a as z,B as f,T as r,m as V,b as $,M as G,N as J,O as y,P as K}from"./index-BroBpP-o.js";import{I as q}from"./IconButton-CyRb5xCv.js";import{C as T,a as Q}from"./CardContent-uUm5Hwwc.js";function U(n,i){const{chainId:c,...o}=i,l=n.getClient({chainId:c});return k(l,B,"getTransaction")(o)}async function X(n,i){const{chainId:c,...o}=i,l=n.getClient({chainId:c});return k(l,L,"getTransactionReceipt")(o)}function Y({myhash:n}){return a.jsx(f,{children:n?a.jsx(a.Fragment,{}):a.jsx(r,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.7)"},children:"No transaction hash available"})})}const ra=({expandedTool:n,handleToolClick:i,setAnchorEl:c})=>{var v,j;const o=M(t=>t.hash.myhash),l=O(),[g,u]=x.useState(!1),[s,C]=x.useState(null),[d,S]=x.useState(null),[m,b]=x.useState(null),w=t=>{t.stopPropagation(),c(t.currentTarget)},A=P(["event Transfer(address indexed from, address indexed to, uint256 value)"]),I=async t=>{try{const e=await X(y,{hash:t});console.log("Transaction receipt:",e);for(const p of e.logs)try{const h=K({abi:A,data:p.data,topics:p.topics});if(h.eventName==="Transfer"){const{from:E,to:F,value:D}=h.args,H=(Number(D)/10**6).toFixed(6);return{tokenAddress:p.address,from:E,to:F,value:H}}}catch(h){console.warn("Skipping non-Transfer log:",h);continue}return null}catch(e){throw console.error("Error fetching receipt:",e),e}},N=async()=>{if(console.log("Todo action triggered with hash:",o),!o){console.log("No hash available for processing"),b("No transaction hash provided"),u(!0);return}try{b(null);const t=await U(y,{hash:o});console.log("Fetched transaction:",t),C(t);const e=await I(o);S(e),u(!0)}catch(t){console.error("Error fetching transaction:",t),b("Failed to fetch transaction details"),u(!0)}},R=t=>{const e=t.target.value;l(J(e||null))};return a.jsxs(W,{sx:{background:"linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%)",borderRadius:1,boxShadow:n==="read"?"0 8px 32px rgba(0, 0, 0, 0.3)":"0 4px 16px rgba(0, 0, 0, 0.2)",transform:n==="read"?"scale(1.02)":"scale(1)",transition:"transform 0.3s ease, box-shadow 0.3s ease",zIndex:n==="read"?2:1,cursor:"pointer",width:{xs:"100%",sm:"400px"},maxWidth:"100%","&:hover":{transform:n!=="read"?"scale(1.05)":"scale(1.02)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"}},onClick:()=>i("read"),children:[a.jsx(z,{title:a.jsxs(f,{width:"100%",textAlign:"center",children:[a.jsxs(r,{variant:"h6",sx:{fontSize:{xs:"1.125rem",sm:"1.25rem"},fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",textShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:[a.jsx(q,{onClick:w,sx:{color:"#ffffff","&:hover":{color:"rgba(255, 255, 255, 0.7)"},mr:1},"aria-label":"Transaction info"}),"Read a Transaction"]}),a.jsx(T,{in:n==="read",children:a.jsx(r,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.7)",fontStyle:"italic"},children:"Read transaction details on SepoliaETH testnet"})})]}),sx:{p:{xs:1.5,sm:2},textAlign:"center"}}),a.jsx(T,{in:n==="read",children:a.jsx(V.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},children:a.jsx(Q,{sx:{p:{xs:2,sm:3},pt:1,background:"rgba(255, 255, 255, 0.05)"},children:a.jsxs(f,{sx:{display:"flex",flexDirection:"column",gap:{xs:1.5,sm:2}},children:[a.jsx($,{label:"Transaction Hash",variant:"outlined",value:o||"",onClick:t=>{t.stopPropagation()},onChange:R,fullWidth:!0,sx:{"& .MuiInputBase-input":{fontSize:{xs:"0.875rem",sm:"1rem"},color:"#ffffff"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.3)"},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},background:"rgba(255, 255, 255, 0.1)",borderRadius:1}}),a.jsx(Y,{myhash:o}),a.jsx(G,{variant:"contained",sx:{mt:2,borderRadius:1,background:"linear-gradient(90deg, #6200ea 0%, #304ffe 100%)",color:"#ffffff","&:hover":{background:"linear-gradient(90deg, #7f39fb 0%, #3f51b5 100%)"},"&:disabled":{background:"rgba(255, 255, 255, 0.3)",color:"rgba(255, 255, 255, 0.5)"}},fullWidth:!0,onClick:t=>{t.stopPropagation(),N()},children:"Search by Hash"}),g&&a.jsx(f,{sx:{mt:2},children:m?a.jsx(r,{variant:"body2",sx:{color:"#f44336"},children:m}):s?a.jsxs(f,{children:[a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["From: ",s.from]}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["To: ",s.to||"N/A"]}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Native Value: ",s.value.toString()," wei"]}),d?a.jsxs(a.Fragment,{children:[a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Token Contract: ",d.tokenAddress]}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Token Amount: ",d.value," tokens"]}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Token From: ",d.from]}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Token To: ",d.to]})]}):a.jsx(r,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.7)"},children:"No token transfer found in this transaction"}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Block Number:"," ",((v=s.blockNumber)==null?void 0:v.toString())||"N/A"]}),a.jsxs(r,{variant:"body2",sx:{color:"#ffffff"},children:["Chain ID: ",((j=s.chainId)==null?void 0:j.toString())||"N/A"]})]}):a.jsx(r,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.7)"},children:"Loading transaction details..."})})]})})})})]})};export{ra as default};
